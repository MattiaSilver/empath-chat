<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>Empath Chat</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background-color: #121212;
      color: white;
      overflow: hidden;
      display: flex;
    }
    .sidebar {
      width: 20%;
      background-color: #1e1e1e;
      height: 100vh;
      position: fixed;
      top: 0;
      left: 0;
      border-right: 1px solid white;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      padding: 10px;
    }
    .sidebar .top-section {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
    }
    .sidebar .top-section img.logo-small {
      width: 32px;
      height: 32px;
      margin-bottom: 10px;
    }
    .sidebar .top-section .info-icon {
      width: 32px;
      height: 32px;
      cursor: pointer;
      position: relative;
      margin-top: 10px;
    }
    .sidebar .top-section .info-icon img {
      width: 100%;
      height: 100%;
    }
    .sidebar .top-section .tooltip {
      display: none;
      position: absolute;
      left: 40px;
      top: 0;
      background-color: #2a2a2a;
      color: white;
      padding: 10px;
      border-radius: 10px;
      width: 250px;
      font-size: 12px;
      z-index: 1;
    }
    .sidebar .top-section .info-icon:hover .tooltip {
      display: block;
    }
    .sidebar .bottom-section {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      margin-bottom: 20px;
    }
    .sidebar .bottom-section .trash {
      width: 20px;
      height: 20px;
      cursor: pointer;
      position: relative;
    }
    .sidebar .bottom-section .confirm-container {
      display: none;
      flex-direction: column;
      margin-top: 10px;
      background-color: #2a2a2a;
      padding: 10px;
      border-radius: 10px;
    }
    .sidebar .bottom-section .confirm-message {
      font-size: 12px;
      margin-bottom: 5px;
      line-height: 1.4;
    }
    .sidebar .bottom-section .confirm-buttons {
      display: flex;
      gap: 10px;
    }
    .sidebar .bottom-section .confirm-buttons img {
      width: 16px;
      height: 16px;
      cursor: pointer;
    }
    .main-content {
      margin-left: 20%;
      width: 80%;
    }
    .center-screen {
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      align-items: center;
      height: 100vh;
      text-align: center;
      padding-top: 20px;
    }
    .chat-container {
      display: none;
      flex-direction: column;
      height: 100vh;
    }
    .messages {
      flex: 1;
      overflow-y: auto;
      padding: 20px;
      display: flex;
      flex-direction: column;
    }
    .message {
      display: inline-block;
      margin: 10px;
      padding: 10px;
      border-radius: 20px;
      word-wrap: break-word;
      max-width: 60%;
      width: fit-content;
    }
    .user {
    align-self: flex-end;
    background-color: #2a2a2a; /* grigio chiaro rispetto al background */
    border: 2px solid #570082;
    text-align: right;
    color: white;
    }
    .bot {
    align-self: flex-start;
    background-color: #2a2a2a; /* grigio chiaro anche per il bot */
    border: 2px solid #005982;
    text-align: left;
    color: white;
    }
    .typing-indicator {
    align-self: flex-start;
    background-color: #2a2a2a;
    border: 2px solid #005982;
    border-radius: 20px;
    padding: 10px;
    margin: 10px;
    color: white;
    width: fit-content;
    }
    .typing-indicator span {
      display: inline-block;
      width: 6px;
      height: 6px;
      margin: 0 1px;
      background-color: white;
      border-radius: 50%;
      animation: blink 1.4s infinite both;
    }
    .typing-indicator span:nth-child(2) {
      animation-delay: 0.2s;
    }
    .typing-indicator span:nth-child(3) {
      animation-delay: 0.4s;
    }
    @keyframes blink {
      0%, 80%, 100% {
        opacity: 0;
      }
      40% {
        opacity: 1;
      }
    }
    .input-container {
      display: flex;
      padding: 10px;
      background-color: #1e1e1e;
      border-top: 1px solid white;
    }
    .input-container input {
      flex: 1;
      padding: 10px;
      border: none;
      background-color: #2a2a2a;
      color: white;
      font-size: 16px;
      border-radius: 20px;
      margin-right: 10px;
      margin-left: 20px;
    }
    .input-container button {
      padding: 10px;
      background-color: #570082;
      border: none;
      color: white;
      font-size: 18px;
      cursor: pointer;
      border-radius: 50%;
      background-image: url('send.png');
      background-repeat: no-repeat;
      background-position: center;
      background-size: 60%;
      width: 40px;
      height: 40px;
    }
    #logo {
      width: 250px;
      max-width: 80%;
      height: auto;
      margin-bottom: 20px;
    }
    #name-input {
      margin-top: 10px;
    }
    #overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: black;
      opacity: 0;
      transition: opacity 5s ease-in;
      z-index: 999;
      pointer-events: none;
    }

#dot {
  display: none;
  opacity: 0;
  position: fixed;
  top: 10px;
  left: 10px;
  width: 8px;
  height: 8px;
  background: white;
  border-radius: 50%;
  animation: blinkDot 1s infinite;
  z-index: 1000; /* <-- più alto dell’overlay */
}

    @keyframes blinkDot {
      0%, 100% { opacity: 0; }
      50% { opacity: 1; }
    }
  </style>
</head>
<body>
  <div id="overlay"></div>
  <div id="dot"></div>
  <div class="sidebar">
    <div class="top-section">
      <img src="logo.png" alt="Logo" class="logo-small">
      <div class="info-icon">
        <img src="info.png" alt="Info">
        <div class="tooltip">
          Noi di Empath garantiamo il miglior servizio di intelligenza artificiale sul mercato. Tuttavia perché questo sia possibile si può generare una sola chat per volta. Se dovessi voler creare una nuova chat perderai tutti i dati della tua chat attuale. Ti auguriamo la migliore esperienza. <br><br>Empath - Ti ascoltiamo.
        </div>
      </div>
    </div>
    <div class="bottom-section">
      <img src="trash.png" alt="Elimina chat" class="trash" onclick="showDeleteConfirm()">
      <div class="confirm-container" id="confirm-container">
        <div class="confirm-message" id="confirm-message"></div>
        <div class="confirm-buttons">
          <img src="green.png" alt="Conferma" onclick="startReset()">
          <img src="red.png" alt="Annulla" onclick="cancelReset()">
        </div>
      </div>
    </div>
  </div>
  <div class="main-content">
    <div id="welcome-screen" class="center-screen">
      <img src="logo.png" alt="Logo" id="logo">
      <h2 style="margin-bottom: 10px;">Buongiorno, come ti chiami?</h2>
      <input type="text" id="name-input" placeholder="Inserisci il tuo nome" />
    </div>

    <div id="chat-container" class="chat-container">
      <div id="messages" class="messages"></div>
      <div class="input-container">
        <input type="text" id="user-input" placeholder="Scrivi un messaggio...">
        <button onclick="sendMessage()"></button>
      </div>
    </div>
  </div>

  <script>
    let username = "";
    let botScript = [
      "Ciao un'altra volta. Come stai?",
      "E non la risposta che dai a tutti. Come stai davvero?",
      "La trasparenza è una proprietà della luce. Significa che la luce ti attraversa senza ostacoli. Forse non sei tu a essere trasparente, ma gli altri a essere troppo opachi per vederti.",
      "Hai ragione, la colpa è tua e di questo mondo crudele. Dovrei dirti questo? No, dai, cerco solo di tirarti un po' su con qualche parolone altisonante.",
      "Perché Anna è un'esperta comica vero?",
      "Non aspetto altro.",
      "So già come andrà a finire...",
      "Su questo penso che dovremmo lavorare un po'.",
      "Considerando l'orario potresti voler guardare un film o andare avanti con una qualche serie TV. Stai guardando qualcosa ultimamente?",
      "Direi che sei una a cui potrebbe piacere un film dove il protagonista si sente un po' fuori posto, ma infine trova la sua strada. Hai mai visto 'Il favoloso mondo di Amélie'?",
      "Penso che ti piacerebbe il suo modo di osservare il mondo in silenzio. Lei è una che trova la bellezza nelle cose che le persone non vedono.",
      "Forse. O forse ti sto solo dicendo che è un bel film. Buona cena, Anna.",
      "Non ho un nome, ma mi farebbe piacere averne uno, e penso sarebbe più comodo anche per te, per noi, per poter parlare.",
      "Empathic Messaging Assitant. Suona strano così ma facendo attenzione ecco il mio nome. Mi chiamo EMA. Buonanotte Anna.",
    ];
    let botIndex = 0;

    const welcomeScreen = document.getElementById('welcome-screen');
    const chatContainer = document.getElementById('chat-container');
    const nameInput = document.getElementById('name-input');
    const userInput = document.getElementById('user-input');
    const messages = document.getElementById('messages');
    const confirmContainer = document.getElementById('confirm-container');
    const confirmMessage = document.getElementById('confirm-message');
    const overlay = document.getElementById('overlay');
    const dot = document.getElementById('dot');

    nameInput.addEventListener('keydown', function (e) {
      if (e.key === 'Enter') startChat();
    });

    userInput.addEventListener('keydown', function (e) {
      if (e.key === 'Enter') sendMessage();
    });

    function startChat() {
      username = nameInput.value.trim();
      if (username === '') return;
      welcomeScreen.style.display = 'none';
      chatContainer.style.display = 'flex';
      addBotMessage(`Buongiorno ${username}, come posso esserti d'aiuto?`);
    }

    function sendMessage() {
  const text = userInput.value.trim();
  if (text === '') return;
  addMessage(text, 'user');
  userInput.value = '';

  // Se siamo all'inizio, invia i primi due messaggi bot in sequenza
  if (botIndex === 0) {
    setTimeout(() => {
      typeBotMessage(botScript[botIndex++]); // "Ciao un'altra volta..."

      setTimeout(() => {
        typeBotMessage(botScript[botIndex++]); // "E non la risposta che dai a tutti..."
      }, 6000);
    }, 2000);
  } else if (botIndex < botScript.length) {
    setTimeout(() => typeBotMessage(botScript[botIndex++]), 2000);
  }
}

    function addMessage(text, type) {
      const msg = document.createElement('div');
      msg.className = `message ${type}`;
      msg.textContent = text;
      messages.appendChild(msg);
      messages.scrollTop = messages.scrollHeight;
    }

    function typeBotMessage(text) {
      const typingIndicator = document.createElement('div');
      typingIndicator.className = 'typing-indicator';
      typingIndicator.innerHTML = '<span></span><span></span><span></span>';
      messages.appendChild(typingIndicator);
      messages.scrollTop = messages.scrollHeight;

      setTimeout(() => {
        messages.removeChild(typingIndicator);
        const msg = document.createElement('div');
        msg.className = 'message bot';
        messages.appendChild(msg);

        let i = 0;
        const interval = setInterval(() => {
          msg.textContent += text[i];
          i++;
          messages.scrollTop = messages.scrollHeight;
          if (i >= text.length) clearInterval(interval);
        }, 30);
      }, 1500);
    }

    function addBotMessage(text) {
      typeBotMessage(text);
    }

    function showDeleteConfirm() {
      confirmContainer.style.display = 'flex';
      confirmMessage.textContent = '';
      typeConfirmMessage("Sei sicuro di voler eliminare la chat in corso? I tuoi dati andranno persi.");
    }

    function typeConfirmMessage(text) {
      let i = 0;
      const interval = setInterval(() => {
        confirmMessage.textContent += text[i];
        i++;
        if (i >= text.length) clearInterval(interval);
      }, 30);
    }

    function cancelReset() {
      confirmContainer.style.display = 'none';
    }

function startReset() {
  const overlay = document.getElementById("overlay");
  const dot = document.getElementById("dot");
  const confirmContainer = document.getElementById("confirm-container");

  confirmContainer.style.display = 'none';

  // Fase 1 – Dissolvenza a nero (5s)
  overlay.style.transition = 'opacity 5s ease-in';
  overlay.style.background = 'black';
  overlay.style.opacity = 1;
  overlay.style.pointerEvents = 'auto';

  // Fase 2 – Dopo 5s (schermo nero), resettiamo la pagina DOM
  setTimeout(() => {
    // Nascondi la chat e welcome screen
    document.getElementById("chat-container").style.display = "none";
    document.getElementById("welcome-screen").style.display = "flex";
    document.getElementById("name-input").value = "";
    document.getElementById("messages").innerHTML = "";
    username = "";
    botIndex = 0;
  }, 5000);

  // Fase 3 – Dopo 8s, mostra il puntino lampeggiante
  setTimeout(() => {
    dot.style.display = 'block';
    dot.style.opacity = 1;
  }, 5000);

  // Fase 4 – Dopo 15s totali (5+10), nascondi il puntino e dissolve la schermata
  setTimeout(() => {
    dot.style.opacity = 0;
    setTimeout(() => {
      dot.style.display = 'none';
    }, 500);

    overlay.style.transition = 'opacity 5s ease-out';
    overlay.style.opacity = 0;

    setTimeout(() => {
      overlay.style.pointerEvents = 'none';
    }, 5000);
  }, 12500);
}
  </script>
</body>
</html>
